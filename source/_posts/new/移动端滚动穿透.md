---
title: 移动端滚动穿透
categories:
  - 尺工
date: 2018-04-09 18:09:17
---
<p></p>
<!-- more -->

## 前言
作移动端项目的时候经常会遇到一个场景，一个全屏幕的遮罩层，然后内部可以滚动，外部不能滚动。讲道理这个需求看起来不麻烦。。。但是意外的实现起来很麻烦。

## 浏览器行为
默认滚动的都是 document.documentElement 这个最外层元素，当内层再出现一个滚动框后滚动行为会变成滚动内层时到达顶部或者底部的时候就去滚动外层元素。

之前在 pc 端时通过 mousewheel 属性的方向以及内部是否滚动到底部和顶部来判断。。现在想起来真是一个蠢方法。。。。

在移动端的时候又遇到了这个问题，然后去搜了下。发现可以采用另一种不同的思路来实现。css 属性的 absolute fixed 属性会默认禁止滚动，利用这个特性就可以很好的去实现这个效果，当遮罩层出现的时候给 body 【或者其他的】元素设置为 fixed，但是这样会丢失滚动记录，fixed不可滚动，所以就需要记录当前屏幕滚动的 scrollTop 值，设置 body 元素的 top，定位过来，当遮罩层消失的时候再设置为 static 就可以完美的实现这个需求了

```
var me = this
var dom = document.querySelector('#app')
if (!me.isShow) {
  me.scrollTop = document.documentElement.scrollTop || document.body.scrollTop
  dom.style.position = 'fixed'
  dom.style.top = `-${me.scrollTop}px`
} else {
  dom.style.position = 'static'
  document.body.scrollTop = document.documentElement.scrollTop = me.scrollTop
}
me.isShow = !me.isShow
```