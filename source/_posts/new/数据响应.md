---
title: 数据响应
categories:
  - 尺工
date: 2017-09-29 15:00:48
---
<p></p>
<!-- more -->
## 前言
前端所做的事情主要就是 
1. 处理数据
2. 展示数据
3. 发送数据

## 数据相应

`view = render(state)`是一句很经典的话。不过一般页面渲染只发生在页面开始加载时或者有事件驱动的时候。而很多需求要求的是动态的更改数据并展示。

### 脏检查 pull
重新拉数据对比

传统的方法是将页面中有绑定数据的节点的虚拟 dom 树和由跟新某个数据产生的新 dom 树全部检测比对后再重新渲染，俗称脏检查。脏检查也有一些优化的方法，比如跳过这个 dom 树中未绑定数据的子树，跳过数据没有变化的子树等。


### vue fetch push
有更改的主动推上去更改

```
<div v-for="item in data" id="box">
	<div id="box1">{{item.name}}</div>
	<div id="box2">{{itme.no}}</div>	
</div>	

```
具体流程拿 vue 的 v-for 来举例子，v-for 的流程其实是先创建一个 dom 树【以使用 v-for 的 dom#box 为根节点】，然后再将这个 dom 渲染到真实的 html dom 树中。如果 item.name 数据有更改，则触发相对应的 getter/setter 更改旧的虚拟 dom 树中的 #box1 节点，再将此虚拟树和 html 中树相替换。以此达到数据响应。




双向绑定其实一样，事件驱动改数据，数据再由上面的渲染后改动页面

但是，这种方法会给所有需要的数据全部加上 getter/setter 来 watch ，比较耗性能。

