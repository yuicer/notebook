---
title: 活动页开发(一)
categories:
  - 尺工
 
date: 2017-03-31 18:41:06
---
<p></p>
<!-- more -->
## 前言
这次单独做了一个 app 内活动页面的开发，遇到了很多坑，在这里总结一下，都是个人意见，如果有错误，请帮忙指正。

## 框架
webpack vue vue-router vueX jq(是不是很好奇为啥用这个。。)

## 开发
最开始没有想用 vuex 和 vue-router 的，因为觉得页面比较简单。

vuex 的话，用起来一大串，特别长，而且遇到数组，对象啥的还容易出问题。
比如一个在 vuex $store.state 中存放的数组内的一个值 a[0] 你在一个地方进行了更改，你在另一个地方发现这个值并没有改变，你必须先 `a = [];a[0] = 1`;这样去修改它才能发现，哦，这个值有变动，vue 中的数组和对象的检查都是这样。另一个存放在 vuex 中的数据用起来特别长的一串，写起来看起来都不舒服。

vue-router 这个最开始是没有想到的，所有的组件都是用弹窗 v-if 去判断，但是在后来的时候发现关闭当前弹窗再打开另一个弹窗的时候不好去控制动画的效果，而且切换比较麻烦，索性就直接用路由来做弹窗了，如下，这样逻辑也清楚很多，动画效果也不错。决定以后就用路由写弹窗算了
******** 
	蠢，，，v-if v-else v-if-else 
********
```
<transition name="fade" mode="out-in">
            <router-view id="zhezhao">
            </router-view>
</transition>
```
如果站点不在根目录，webpack 需要更改脚本命令 build 中路径，改为相对 `assetsPublicPath: './',`



还有一个遇到的坑是在动画里面，像`@-webkit-keyframes`这样的，webpack打包的时候不知道为什么会出错，在打包后的文件里面你就找不到这个前缀，所以动画有的时候就不执行，后来把这个放到静态文件里面 require 进来。

另外在用 vue-resource 的时候很奇怪的发现在安卓 4.2 的 vivo 机上不起作用。不知道是请求没有发还是请求发了接受后处理的时候出了问题，后来没办法用上了 jq 里封装的 ajax 方法去请求接口。而且这个 jq 用 require 竟然还进不来，只能用 script 标签
****
后来没遇到过，不知道当初这个问题是什么样
****

除此之外遇到的 bug 全都是在那个测试机 安卓 4.2 的 vivo 手机上。。。。各种诡异。大部分时间都是改它
1.圆边框出不来，是个正方形，这个样式够简单了吧`border-radius:50%`,可是当我又写了一个`border`属性的时候它就显示出一个正方形，你说气不气。
2.细线出不来。想要一个 0.2px 高的细线就是不出来，后来从`.01rem`改到`1px`，`scaley(.2)`改到 .5 才出来
3.flex布局出错，没找到原因，后来没用flex了；
4.`overflow:auto`后竟然还可以触发被隐藏部分的点击事件（滚动条没滑到底），贼可怕，点击这个元素可以触发到兄弟元素的子元素上的点击事件。。。后来给外层又加了一个`overflow:hidden`的盒子才终于解决了一点，虽然还能点但是不影响功能的状态。
5.动画卡，canvas 啥的基本不要想，后来做判断安卓4.4一下不执行canvas，另外在苹果 app 里的 canvas，即使把这个 webview 退到后台，好像也还是一直在执行，并且你在回去的时候如果数据量比较大会直接卡死，讲道理，退到后台之后，应该是出于暂停状态不会运行的，哎。
6.不支持 vw calc 


还有一些小的就不说了，这玩意简直能当作是一生之敌，

## 小方法
匹配 url 中的某一项参数
```
var some = '',
    a = location.href.split('?')[1] ? location.href.split('?')[1].split('&') : [];
for (var i = 0; i < a.length; i++) {
    if (a[i].match(/canshu/i)) {
        some = a[i].split('=')[1].replace(/#.{0,}$/, '');
        break;
    }
}
```
取 cookie 值  
```
var some;
for (var a = document.cookie.split(';'), i = 0; i < a.length; i++) {
    if (a[i].match(/cookieeee/i)) {
        some = a[i].split('=')[1];
    }
}
```
vue transition 动画
```
.fade-enter-active,
.fade-leave-active {
    transition: opacity .2s
}

.fade-enter,
.fade-leave-active {
    opacity: 0;
}
```
改 placehoder 样式
```
 ::placeholder {
    color: #999;
    font-size: .28rem;
}
```
## 最后
深深的体会到了要兼容各种机子的恶意啊。。。什么时候能淘汰安卓4.4 app 内的 webview 啊。。。。简直就是ie6啊。。。。。

